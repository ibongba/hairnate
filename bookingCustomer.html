<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="Description" content="Enter your description here" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
    <link href='css/main.css' rel='stylesheet' />
    <!-- Stepper CSS -->
    <!-- <link href="css/addons-pro/steppers.css" rel="stylesheet"> -->
    <!-- Stepper CSS - minified-->
    <!-- <link href="css/addons-pro/steppers.min.css" rel="stylesheet"> -->


    <title>BOOKING</title>
</head>



<body>
    <div id="nav"></div>
    <div class="container">
        <!-- Steps form -->
        <!-- <div class="card " style="background-color: #fff;"> -->
        <h2 class="text-center pt-4 pb-5" style="color: #A33E3E;">PHEEN BARBER SHOP</h2>
        <!-- <div class="card-body col-sm-12 mb-4"> -->
        <!-- Stepper -->
        <div class="steps-form">
            <div class="steps-row setup-panel">
                <div class="steps-step">
                    <a href="#step-9" type="button" class="btn btn-indigo btn-circle"><i class="far fa-credit-card" style="font-size: xx-large;"></i></a>
                </div>
                <div class="steps-step">
                    <a href="#step-10" type="button" class="btn btn-default btn-circle disabled"><i class="fas fa-calendar-week" style="font-size: xx-large;"></i></a>
                </div>
                <div class="steps-step">
                    <a href="#step-11" type="button" class="btn btn-default btn-circle disabled"><i class="fas fa-map-marker-alt" style="font-size: xx-large;"></i></a>
                </div>
                <div class="steps-step">
                    <a href="#step-13" type="button" class="btn btn-default btn-circle disabled"><i class="fas fa-bars" style="font-size: xx-large;"></i></a>
                </div>
                <div class="steps-step">
                    <a href="#step-14" type="button" class="btn btn-default btn-circle disabled"><i class="far fa-check-circle" style="font-size: xx-large;"></i></a>
                </div>
            </div>
        </div>

        <form role="form" action="" method="post" style="background-color:#FAF9F7;">

            <!-- First Step -->
            <div class="row setup-content" id="step-9">
                <div class="col-md-12 pb-5">
                    <h5 class=" my-4">Step 1 CHOOSE BARBER
                        <i class="fas fa-search text-center" style="width: 40px; background-color: #C1B09D; border-radius: 15px; color: #EEEBE6;"></i>
                    </h5>
                    <div class="row">
                        <div class="col-12 text-center mr-auto">
                            <div class="row pt-3" id="barber">
                            </div>
                        </div>
                        <div class="col-12">
                            <hr style="border-bottom:1px solid #EEEBE6;" />
                        </div>
                    </div>
                    <h5 class=" mt-4">Step 2 CHOOSE HAIRSTYLE</h5>
                    <div class="col-12">
                        <div class="row" id='service'>
                        </div>
                    </div>
                    <!--  <div class="col-12">
                        <hr style="border-bottom:1px solid #EEEBE6;" />
                    </div> -->
                    <h5 class=" my-4">Step 3 UPLOAD YOUR HAIRSTYLE</h5>
                    <div class="row">
                        <div class="col-md-6 col-sm-12">
                            <div class="box2" style="height: 350px;">
                                <div class="wrapper">
                                    <div class="drop">
                                        <i class="fas fa-camera is-remove" style="font-size: xxx-large; padding-top: 7rem; color: #C1B09D;"></i>
                                        <p class="is-remove" style="color: #C1B09D;">อัพโหลดรูปภาพ</p>
                                        <output id="list3"></output><input id="files" max="1" name="files[]" type="file" />
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 col-sm-12">
                            <div class="box2" style="height: 350px;">
                                <div class="wrapper">
                                    <div class="drop">
                                        <i class="fas fa-camera is-remove" style="font-size: xxx-large; padding-top: 7rem; color: #C1B09D;"></i>
                                        <p class="is-remove" style="color: #C1B09D;">อัพโหลดรูปภาพ</p>
                                        <output id="list2"></output><input id="files2" max="1" name="files[]" type="file" />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <a id="ref" style="margin: auto;"><button type="button" class="btn btn-dark btn-rounded my-3  float-left">BACK</button></a>
                <button type="button" class="btn btn-dark btn-rounded nextBtn my-3  text-center">NEXT</button>

            </div>

            <!-- Second Step -->
            <div class="row setup-content" id="step-10">
                <div class="col">
                    <div id='calendar' style="color: #C1B09D;"></div>
                </div>

                <div class="col float-left ">
                    <h3 class="text-center my-3">TIMES</h3>
                    <!-- <div class="col my-1">
                        <select class="custom-select mr-sm-2" id="inlineFormCustomSelect">
                          <option selected>Choose...</option>
                          <option value="1">ช่วงเช้า</option>
                          <option value="2">ช่วงบ่าย</option>
                        </select>
                    </div> -->
                    <div class="row">
                        <div class="col-6 is-moring d-none">
                            <button class="btn btn-dark col-md-6 m-0 p-2 w-100" type="button" data-toggle="collapse" data-target="#multiCollapseExample1" aria-expanded="false" aria-controls="multiCollapseExample1" style="width: auto;">ช่วงเช้า</button>
                        </div>
                        <div class="col-6 is-evening">
                            <button class="btn btn-dark col-md-6 p-2 m-0 w-100" type="button" data-toggle="collapse" data-target="#multiCollapseExample2" aria-expanded="false" aria-controls="multiCollapseExample2" style="width: auto;">ช่วงบ่าย</button>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col is-moring d-none">
                            <div class="collapse multi-collapse" id="multiCollapseExample1">
                                <br>
                                <button onclick="select(this)" type="button" class="btn btn-dark col m-0 w-100 time">09.00</button><br>
                                <button onclick="select(this)" type="button" class="btn btn-dark col m-0 w-100 time">10.00</button><br>
                                <button onclick="select(this)" type="button" class="btn btn-dark col m-0 w-100 time">11.00</button>
                            </div>
                        </div>
                        <div class="col is-evening">
                            <div class="collapse multi-collapse" id="multiCollapseExample2">
                                <br>
                                <button onclick="select(this)" type="button" class="btn btn-dark col m-0 w-100 time">13.00</button><br>
                                <button onclick="select(this)" type="button" class="btn btn-dark col m-0 w-100 time">14.00</button><br>
                                <button onclick="select(this)" type="button" class="btn btn-dark col m-0 w-100 time">15.00</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-12 pt-5">

                    <button type="button" class="btn btn-dark btn-rounded prevBtn my-3 col-md-4 float-left">BACK</button>
                    <button type="button" class="btn btn-dark btn-rounded nextBtn my-3 col-md-4 float-right" id="btn-10" disabled="disabled">NEXT</button>
                </div>
            </div>

            <!-- Third Step -->
            <div class="row setup-content" id="step-11">
                <h5 class="col-12 my-4 text-center">ADDRESS</h5>
                <div class="col-sm-12 col-md-6">
                    <div class="form-group row w-100 md-form">
                        <label for="inputEmail3" class="col-sm-4 col-form-label">ที่อยู่เลขที่ : </label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" id="address">
                        </div>
                    </div>
                </div>
                <div class="col-sm-12 col-md-6">
                    <div class="form-group row w-100 md-form">
                        <label for="inputEmail3" class="col-sm-4 col-form-label">หมู่บ้าน / อาคาร : </label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" id="moo">
                        </div>
                    </div>
                </div>
                <div class="col-sm-12 col-md-6">
                    <div class="form-group row w-100 md-form">
                        <label for="inputEmail3" class="col-sm-4 col-form-label">ตรอก / ซอย : </label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" id="soi">
                        </div>
                    </div>
                </div>
                <div class="col-sm-12 col-md-6">
                    <div class="form-group row w-100 md-form">
                        <label for="inputEmail3" class="col-sm-4 col-form-label">ถนน : </label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" id="road">
                        </div>
                    </div>
                </div>
                <div class="col-sm-12 col-md-6">
                    <div class="form-group row w-100 md-form">
                        <label for="inputEmail3" class="col-sm-4 col-form-label">ตำบล / เขต : </label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" id="kad">
                        </div>
                    </div>
                </div>
                <div class="col-sm-12 col-md-6">
                    <div class="form-group row w-100 md-form">
                        <label for="inputEmail3" class="col-sm-4 col-form-label">อำเภอ : </label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" id="amper">
                        </div>
                    </div>
                </div>
                <div class="col-sm-12 col-md-6">
                    <div class="form-group row w-100 md-form">
                        <label for="inputEmail3" class="col-sm-4 col-form-label">จังหวัด : </label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" id="jakwad">
                        </div>
                    </div>
                </div>
                <div class="col-sm-12 col-md-6">
                    <div class="form-group row w-100 md-form">
                        <label for="inputEmail3" class="col-sm-4 col-form-label">รหัสไปรษณีย์ : </label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" id="pnum">
                        </div>
                    </div>
                </div>
                <h3 class="p-5 col-md-6 col-sm-12">ข้อมูลติดต่อ</h3>
                <div class="col-sm-12 col-md-6 pb-5">
                    <div class="form-group row w-100 md-form">
                        <label for="inputEmail3" class="col-sm-4 col-form-label">เบอร์โทรศัพท์ : </label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" id="phone">
                        </div>
                    </div>
                    <div class="form-group row w-100 md-form">
                        <label for="inputEmail3" class="col-sm-4 col-form-label">Email : </label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" id="email">
                        </div>
                    </div>
                </div>
                <button type="button" class="btn btn-dark btn-rounded prevBtn my-4 col-md-4 float-left">BACK</button>
                <button onclick="addCalenda()" type="button" class="btn btn-dark btn-rounded nextBtn my-4 col-md-4 text-center">NEXT</button>
            </div>


            <!--   <div class="row setup-content" id="step-12">
                <div class="col-md-12">
                    <h5 class=" my-4 text-center">WAITING FOR APPROVAL !!</h5>
                    <div class="text-center p-3" style="background-color:#EEEBE6; border-radius: 25px;">
                        <i class="fas fa-check col-md-8 text-center" style="color: #A33E3E; font-size: 100px"></i>
                        <p class="col-md-12" style="color: #A33E3E;">THANKYOU FOR YOUR APPOINMENT</p>
                        <p class="col-md-12">ทางร้านรับทราบการจองบริการของคุณ JUSTIN แล้วครับ!!</p>
                        <p class="col-md-12">รอทางร้าน Confirm กลับมาเพื่อยืนยันการจองบริการ</p>
                        <p class="col-md-12">และทำการชำระเงินหลังจากที่ทางร้านยืนยัน</p>
                        <p class="col-md-12">เพียงเท่านี้ก็เรียบร้อยครับ ;)</p>
                    </div>
                </div>
            </div> -->

            <div class="row setup-content" id="step-13">
                <div class="col-12">
                    <button type="button" class="btn btn-danger float-right" data-toggle="modal" data-target="#exampleModal">
                    คำเตือน
                </button>
                </div>


                <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                            </div>
                            <div class="modal-body text-center">
                                <p><b>เงื่อนไขแจ้งให้ทราบก่อนทำการชำระเงิน</b></p>
                                <p>เมื่อยืนยันและชำระเงินเป็นที่เรียบร้อยแล้ว</p>
                                <p>หากต้องการยกเลิกการจองการบริการ ทาง Hairnate มีเงื่อนไขดังนี้</p>
                                <p>1. หาก
                                    <font class="text-success">ยกเลิกบริการล่วงหน้า 3 วัน </font>ท่านจะได้รับ
                                    <font class="text-success">เงินคืน 100% </font>
                                </p>
                                <p>2. หาก
                                    <font class="text-warning">ยกเลิกบริการล่วงหน้า 2 วัน </font>ท่านจะได้รับ
                                    <font class="text-warning">เงินคืน 90%</font>
                                </p>
                                <p>3. หาก
                                    <font class="text-danger">ยกเลิกบริการล่วงหน้าเพียง 1 วัน </font>ท่านจะได้รับ
                                    <font class="text-danger">เงินคืน 80% </font>
                                </p>
                                <br>
                                <p>
                                    <font class="text-danger">*</font> เพื่อความเท่าเทียมและความสบายใจของทั้ง 2 ฝ่าย <br>จึงเรียนมาเพื่อทราบ
                                    <font class="text-warning">;)</font>
                                </p>

                            </div>
                        </div>
                    </div>
                </div>
                <h5 class="col-12 my-4 text-center">PAYMENT</h5>
                <div class="row">
                    <div class="col">
                        <div class="card" style="border-radius: 25px;">
                            <div class="card-body add-detail">
                                <h5 class="card-title"><b>Service</b></h5>
                                <p class="card-text">COACH CRAFTSMAN
                                    <p>Package A : Under Cut + ไถข้าง</p>
                                    <p>ที่อยู่ : 365 Bond, Chang Wat Nonthaburi 11120</p>
                                </p>
                                <br>
                                <h5 class="card-title"><b>วันที่ใช้บริการ</b></h5>
                                <h4 class="card-text"><b>วันจันทร์ 1 มีนาคม 07.00</b></h4>
                                <br>
                                <p class="card-text">ราคาเต็ม : 650 Bath
                                    <p>ส่วนลดจาก promotion : -10 Bath</p>
                                </p>
                                <br>
                                <h4 class="card-title"><b>รวมทั้งสิ้น : </b><b style="color: #48B7A4;">640 Bath</b></h4>

                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="card" style="border-radius: 25px;">
                            <div class="card-body">
                                <h5 class="card-title"></h5>
                                <p class="card-text"><b>รายละเอียดการ์ด</b></p>

                                <label for="card_no">เลขการ์ด</label>
                                <input type="tel" class="form-control identified" maxlength="16" id="card_no" name="card_no" required="" data-toggle="tooltip" data-placement="top" title="" data-original-title="This one is serious as I do want my money.. The credit card number is a 16 digit number, usually written 4 at a time on top of your credit card. " placeholder="#### #### #### ####"  style="background-color: #fff;">

                                <label for="card_name">ชื่อของผู้ถือการ์ด</label>
                                <input type="text" class="form-control" id="card_name" name="card_name" aria-describedby="emailHelp" style="background-color: #fff;">
                                <div class="row">
                                    <div class="col"> <label for="month" class="my-4">วันหมดอายุ</label></div>
                                    <div class="col"><label for="cvc" class="my-4">เลข CVC</label><br></div>
                                </div>
                                <div class="row mb-5">
                                    <div class="col">
                                        <input type="number" class="form-control col-3 text-center float-left pr-1" id="month" name="month" placeholder="MM" style="background-color: #fff;">
                                        <input type="number" class="form-control col-4 text-center" id="year" name="year" placeholder="YYYY" style="background-color: #fff;">
                                    </div>
                                    <div class="col">
                                        <input type="text" class="form-control" id="cvc" name="cvc" style="background-color: #fff;">
                                    </div>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="notification" name="notification">
                                    <label class="form-check-label" for="notification">
                                      รับข่าวสารและการอัพเดตผ่านเบอร์โทรศัพท์
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <button type="button" class="btn btn-dark btn-rounded prevBtn my-4 col-md-4 float-left">BACK</button>
                <button type="button" class="btn btn-dark btn-rounded nextBtn my-4 col-md-4 text-center" onclick="createPayment()">NEXT</button>

            </div>

            <div class="row setup-content" id="step-14" style="margin: auto;">
                <h2 class="col-12 my-4 text-center"><i class="fas fa-check-circle" style="color: #7DE875;"></i> จองสำเร็จ</h2>
                <div class="card col-sm-12 m-0" style="border-radius: 25px;">
                    <div class="card-body add-detail">
                    </div>
                </div>
            </div>
        </form>
    </div>

    <footer>
        <div class="container ">
            <div class="foot_logo pt-5 ">
                <img class="logo-img center-block " src="images/logo-app-white.png " />
            </div>

            <div class="footer_text ">
                เว็บแอพพลิเคชั่นรวบรวมร้านตัดผมแฟชั่นชาย และตัดผลบริจาคแบบ Delivery ในเขตกรุงเทพมหานครและปริมณฑล
            </div>


            <div class="foot_icon ">
                <a href="# "><i class="fab fa-facebook "></i></a>
                <a href="# "><i class="fab fa-twitter "></i></a>
                <a href="# "><i class="fab fa-instagram "></i></a>
            </div>
        </div>
    </footer>
    <!-- <script type="text/javascript" src="js/addons-pro/steppers.min.js"></script> -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.1/umd/popper.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script>
        $(function() {
            $('#nav').load("layout/navbar.html");
        });
    </script>
    <script src='js/main.js'></script>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.10.2/fullcalendar.min.js"></script> -->
    <!-- Stepper JavaScript -->
    <!-- <script type="text/javascript" src="js/addons-pro/steppers.js"></script> -->
    <!-- Stepper JavaScript - minified -->
    <!-- <script type="text/javascript" src="js/addons-pro/steppers.min.js"></script> -->
    <!-- stepper -->
    <script>
        const listMonth = ["มกราคม", "กุมภาพันธ์", "มีนาคม", "เมษายน", "พฤษภาคม", "มิถุนายน", "กรกฎาคม", "สิงหาคม", "กันยายน", "ตุลาคม", "พฤศจิกายน", "ธันวาคม"];

        const formatDate = (date) => {
            console.log(date);
            return date.getDate() + ' ' + listMonth[date.getMonth()].toLocaleUpperCase() + ' ' + (date.getFullYear() + 543);
        };

        let date = null;

        $('#files').change((e) => handleFileSelect(e, 'list3'));
        $('#files2').change((e) => handleFileSelect(e, 'list2'));

        function handleFileSelect(evt, id) {
            var files = evt.target.files; // FileList object

            // Loop through the FileList and render image files as thumbnails.
            for (var i = 0, f; f = files[i]; i++) {

                // Only process image files.
                if (!f.type.match('image.*')) {
                    continue;
                }

                var reader = new FileReader();

                // Closure to capture the file information.
                reader.onload = (function(theFile) {
                    return function(e) {
                        // Render thumbnail.
                        var span = document.createElement('span');
                        span.innerHTML = ['<img class="thumb" style="width:auto;min-height:200px" src="', e.target.result,
                            '" title="', escape(theFile.name), '"/>'
                        ].join('');
                        $('#' + id).empty();
                        document.getElementById(id).insertBefore(span, null);
                    };
                })(f);

                $('#' + id).parent().children('.is-remove').remove()

                // Read in the image file as a data URL.
                reader.readAsDataURL(f);
            }
        }
        let time = '';

        var listHairStyle = []
        var listBarber = []
        var partner = {}

        $(document).ready(function() {

            $('#ref').attr('href', 'bookingHome.html?id=' + getUrlVars()['id'])

            var navListItems = $('div.setup-panel div a'),
                allWells = $('.setup-content'),
                allNextBtn = $('.nextBtn'),
                allPrevBtn = $('.prevBtn');

            allWells.hide();

            navListItems.click(function(e) {
                e.preventDefault();
                var $target = $($(this).attr('href')),
                    $item = $(this);

                if (!$item.hasClass('disabled')) {
                    navListItems.removeClass('btn-indigo').addClass('btn-default');
                    $item.addClass('btn-indigo');
                    allWells.hide();
                    $target.show();
                    $target.find('input:eq(0)').focus();
                }
            });

            allPrevBtn.click(function() {
                var curStep = $(this).closest(".setup-content"),
                    curStepBtn = curStep.attr("id"),
                    prevStepSteps = $('div.setup-panel div a[href="#' + curStepBtn + '"]').parent().prev().children("a");

                prevStepSteps.removeAttr('disabled').trigger('click');
            });

            allNextBtn.click(function() {
                var curStep = $(this).closest(".setup-content"),
                    curStepBtn = curStep.attr("id"),
                    nextStepWizard = $('div.setup-panel div a[href="#' + curStepBtn + '"]').parent().next().children("a"),
                    curInputs = curStep.find("input[type='text'],input[type='url']"),
                    isValid = true;

                if (curStepBtn != 'step-10' || time) nextStepWizard.removeClass('disabled')


                $(".form-group").removeClass("has-error");
                for (var i = 0; i < curInputs.length; i++) {
                    if (!curInputs[i].validity.valid) {
                        isValid = false;
                        $(curInputs[i]).closest(".form-group").addClass("has-error");
                    }
                }

                if (isValid)
                    nextStepWizard.removeAttr('disabled').trigger('click');
            });

            $('div.setup-panel div a.btn-indigo').trigger('click');

            $('#service').empty();
            $('#barber').empty();

            $.ajax({
                method: "POST",
                url: "service/core.php",
                data: {
                    action: 'get_partner_with_id',
                    id: getUrlVars()['id']
                },
                dataType: 'json',
                // contentType: false,
                // processData: false,
            }).done(function(msg) {
                let data = JSON.parse(msg.result)
                listBarber = [...data.barber]
                data.barber.map((item, i) => {
                    $('#barber').append(barberCard(item, i))
                })

                listHairStyle = [...data.hairstyle]
                data.hairstyle.map((item, i) => {
                    $('#service').append(serviceCard(item, i))
                })

                partner = data.partner
                selectBarber();

            });


        });



        var list = [];

        const selectBarber = () => {
            $.ajax({
                method: "POST",
                url: "service/core.php",
                data: {
                    action: 'get_order_by_barber',
                    id_barber: $('input[name=barber]:checked').val(),
                },
                dataType: 'json',
            }).done(async function(msg) {
                list = msg.result.map((item) => {
                    let tmp = {};
                    tmp.title = "มีการจองไว้ : " + item.service_time;
                    tmp.start = item.service_date;
                    return tmp;
                })
                $('.is-evening').addClass('d-none')
                $('.is-moring').addClass('d-none')

                CreateCalenda()
            });
        }


        document.addEventListener('DOMContentLoaded', function() {
            CreateCalenda()
        });


        const CreateCalenda = () => {

            var calendarEl = document.getElementById('calendar');
            var calendar = new FullCalendar.Calendar(calendarEl, {
                // headerToolbar: {
                //     left: 'prev,next today',
                //     center: 'title',
                //     right: 'dayGridMonth,timeGridWeek,timeGridDay'
                // },
                initialDate: new Date(),
                navLinks: false, // can click day/week names to navigate views
                selectable: true,
                selectMirror: true,
                select: function(arg) {
                    if (arg.start < new Date()) {
                        calendar.unselect()
                        return;
                    }

                    if (confirm('คุณต้องการจองในวันที่ ' + formatDate(arg.start) + ' ?')) {
                        if (date != null) {
                            calendar.getEventById(date).remove()
                        }

                        time = '';

                        $.ajax({
                            method: "POST",
                            url: "service/core.php",
                            data: {
                                action: 'get_order_by_barber',
                                id_barber: $('input[name=barber]:checked').val(),
                                service_date: formatDate2(arg.start)
                            },
                            dataType: 'json',
                            // contentType: false,
                            // processData: false,
                        }).done(function(msg) {
                            console.log(msg);
                            $('.is-evening').removeClass('d-none')
                            $('.is-moring').removeClass('d-none')

                            list = msg.result.map((item) => {
                                    if (parseInt(item.service_time) > 12) $('.is-evening').addClass('d-none')
                                    if (parseInt(item.service_time) < 12) $('.is-moring').addClass('d-none')

                                    let tmp = {};
                                    tmp.title = "มีการจองไว้ : " + item.service_time;
                                    tmp.start = item.service_date;
                                    return tmp;
                                })

                        });

                        calendar.addEvent({
                            id: arg.start,
                            title: 'จอง',
                            start: arg.start,
                            end: arg.end,
                            allDay: arg.allDay
                        })

                        date = arg.start
                    }
                    // var title = prompt('Event Title:');
                    // if (title) {
                    //     calendar.addEvent({
                    //         title: title,
                    //         start: arg.start,
                    //         end: arg.end,
                    //         allDay: arg.allDay
                    //     })
                    // }
                    calendar.unselect()
                },
                editable: true,
                dayMaxEvents: true, // allow "more" link when too many events
                events: list
                    // events: [{
                    //     title: 'All Day Event',
                    //     start: '2020-06-01'
                    // }, {
                    //     title: 'Long Event',
                    //     start: '2020-06-07',
                    //     end: '2020-06-10'
                    // }, {
                    //     groupId: 999,
                    //     title: 'Repeating Event',
                    //     start: '2020-06-09T16:00:00'
                    // }, {
                    //     groupId: 999,
                    //     title: 'Repeating Event',
                    //     start: '2020-06-16T16:00:00'
                    // }, {
                    //     title: 'Conference',
                    //     start: '2020-06-11',
                    //     end: '2020-06-13'
                    // }, {
                    //     title: 'Meeting',
                    //     start: '2020-06-12T10:30:00',
                    //     end: '2020-06-12T12:30:00'
                    // }, {
                    //     title: 'Lunch',
                    //     start: '2020-06-12T12:00:00'
                    // }, {
                    //     title: 'Meeting',
                    //     start: '2020-06-12T14:30:00'
                    // }, {
                    //     title: 'Happy Hour',
                    //     start: '2020-06-12T17:30:00'
                    // }, {
                    //     title: 'Dinner',
                    //     start: '2020-06-12T20:00:00'
                    // }, {
                    //     title: 'Birthday Party',
                    //     start: '2020-06-13T07:00:00'
                    // }, {
                    //     title: 'Click for Google',
                    //     url: 'http://google.com/',
                    //     start: '2020-06-28'
                    // }]
            });

            calendar.render();
        }


        function getUrlVars() {
            var vars = [],
                hash;
            var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
            for (var i = 0; i < hashes.length; i++) {
                hash = hashes[i].split('=');
                vars.push(hash[0]);
                vars[hash[0]] = hash[1];
            }
            return vars;
        }


        const serviceCard = (item, i) => {
                return `
                    <div class="col-lg-6 col-sm-12  p-3">
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="hairstyle" id="service${item.id_hairstyle}"  ${i === 0 ? 'checked=""' : ''} value="${item.id_hairstyle}">
                            <label class="form-check-label px-5" for="service${item.id_hairstyle}">
                                <div class="col">
                                    <div class="row py-3">
                                        <div class="col-12 col-md p-2">
                                            <div class="proimage" style="width: 100%;">
                                                <img src="${item.image}" style="width: 100%;border-radius: 15px;">
                                            </div>
                                            <br/>
                                        </div>
                                        <div class="col-12 col-md p-2">

                                            <h5>${item.name}</h5>
                                            <p style="font-size: xx-small;">${item.description}</p>
                                            <p><span ${item.promotion_price > 0 ? ' style="text-decoration: line-through;font-size:14px""': ''}>${item.price}</span> ${item.promotion_price > 0 ? `<span style="color: #A33E3E; font-size:16px">${item.promotion_price} Baht</span>` : ""}</p>
                                        </div>
                                    </div>
                                </div>

                            </label>
                        </div>
                    </div>`
        }

        const select = (e) => {
            $('.time').removeClass('bg-red');
            $(e).addClass('bg-red');


            $('#btn-10').removeAttr("disabled")
            time = $(e).text();
        }

        const barberCard = (item,i) => {
            return `
                    <div class="col-4">
                        <input class="form-check-input" type="radio" onchange="selectBarber()" name="barber" id="barber${item.id_barber}" ${i === 0 ? 'checked=""' : ''} value="${item.id_barber}">
                        <label class="form-check-label px-5" for="barber${item.id_barber}">
                                <div class="icon">
                                    <div class="position-relative">
                                        <img class="circle" src="${item.image}" />
                                        <p style="text-align: center;" class="pt-2 text-dark">ช่าง${item.name}</p>
                                    </div>
                                </div>
                        </label>
                    </div>`;
        }

        function formatDate2(date) {
            var d = new Date(date),
                month = '' + (d.getMonth() + 1),
                day = '' + d.getDate(),
                year = d.getFullYear();

            if (month.length < 2) 
                month = '0' + month;
            if (day.length < 2) 
                day = '0' + day;

            return [year, month, day].join('-');
        }

        let lastid = '';

        const addCalenda = () => {


            var form_data = new FormData();
            var totalfiles = document.getElementById('files').files.length;
            for (var index = 0; index < totalfiles; index++) {
                form_data.append("files[]", document.getElementById('files').files[index]);
            }

            totalfiles = document.getElementById('files2').files.length;
            for (var index = 0; index < totalfiles; index++) {
                form_data.append("files[]", document.getElementById('files2').files[index]);
            }
            form_data.append('action', 'add_calendar');
            form_data.append('id_users', JSON.parse(localStorage.getItem('user')).id);
            form_data.append('id_barber', $('input[name=barber]:checked').val());
            form_data.append('id_hairstyle', $('input[name=hairstyle]:checked').val());
            form_data.append('service_date', formatDate2(date));
            form_data.append('service_time', time);

                
            let location = $('#address').val() + ' ' + $('#moo').val() + ' ' + $('#road').val() + ' ' + $('#kad').val() + ' ' + $('#amper').val() + ' ' + $('#jakwad').val() + ' ' + $('#pnum').val();

            form_data.append('service_location', location);
            form_data.append('service_phone', $('#phone').val());
            form_data.append('email', $('#email').val());

            $.ajax({
                method: "POST",
                url: "service/core.php",
                data: form_data,
                dataType: 'json',
                contentType: false,
                processData: false, 
                async: false,
                success: callBack
            })
            
        }

        const callBack = (msg) => {
                console.log(listHairStyle,listBarber)
            console.log(msg)
            // msg = JSON.parse(msg)
            if (msg.code !== 200) {
                alert('ตรวจพบปัญหากรุณาติดต่อ call center')
                // window.location.href = "book.html";
                // 
            }else{
                lastid = msg.result.lastid
                let hairstyle = listHairStyle.find((item)=>item.id_hairstyle === $('input[name=hairstyle]:checked').val())
                let barber = listBarber.find((item)=>item.id_barber === $('input[name=barber]:checked').val())

                $('.add-detail').empty();
                $('.add-detail').append(cardDetailOrder(barber,hairstyle))
            }
        }

        const createPayment = () => {

            var form_data = new FormData();
            form_data.append('action', 'add_payment');
            form_data.append('card_name', $('#card_name').val());
            form_data.append('card_no', $('#card_no').val());
            form_data.append('month', $('#month').val());
            form_data.append('year', $('#year').val());
            form_data.append('cvc', $('#cvc').val());
            form_data.append('notification', $('input[name=notification]:checked').length > 0 ? 1 : 0);
            form_data.append('lastid',lastid);

            $.ajax({
                method: "POST",
                url: "service/core.php",
                data: form_data,
                dataType: 'json',
                contentType: false,
                processData: false, 
                async: false
            }).done((msg)=>{
                console.log(msg)
                // msg = JSON.parse(msg)
                if (msg.code !== 200) {
                    alert('ตรวจพบปัญหากรุณาติดต่อ call center')
                    // window.location.href = "book.html";
                    // 
                }
            })

        }

        const cardDetailOrder = (barber,hairstyle) => {
            let text = hairstyle.promotion_price ? `<p class="card-text">ราคาเต็ม : ${hairstyle.price} Bath
                        <p>ส่วนลดจาก promotion : -${hairstyle.promotion_price - hairstyle.price} Bath</p>
                        </p>
                        <br>`: ''
                        // 
            return `
                        <h5 class="card-title text-center"><b>ORDER ID : ${lastid}</b></h5>
                        <p class="card-text"><b>${partner.biz_name}</b>
                            <p>${hairstyle.description}</p>
                            <p>ที่อยู่ : ${$('#address').val() + ' ' + $('#moo').val() + ' ' + $('#road').val() + ' ' + $('#kad').val() + ' ' + $('#amper').val() + ' ' + $('#jakwad').val() + ' ' + $('#pnum').val()}</p>
                        </p>
                        <br>
                        <h5 class="card-title"><b>วันที่ใช้บริการ</b></h5>
                        <h4 class="card-text"><b>${formatDate(date)} &nbsp; ${time}</b></h4>
                        <br>
                        
                        <h4 class="card-title"><b>รวมทั้งสิ้น : </b><b style="color: #48B7A4;">${hairstyle.promotion_price||hairstyle.price} Bath</b></h4>
            `;
        }
    </script>
</body>

</html>