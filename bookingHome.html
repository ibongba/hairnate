<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="Description" content="Enter your description here" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
    <title>BOOKING HOME</title>
</head>

<body>
    <div id="nav"></div>
    <div style="max-height: 100vh; overflow: hidden;">        
        <img id="image" src="https://via.placeholder.com/1920x600.png?text=ไม่มีรูป" alt="" class="w-100">
    </div>
    <div class="container">
        <div class="row my-5">
            <div class="col">
                <div>
                    <h5 class="float-left" id="name"></h5>&nbsp;
                    <a id="ref" href="bookingCustomer.html" class="btn btn-danger" style="background-color: #A33E3E; border-radius: 25px;">จองคิว</a>
                </div>
                <p id="detail"></p>
            </div>
            <p class="mx-3">200 <br> review </p>
            <p style="border:1px #C1B09D solid;"></p>&nbsp;
            <p class="mx-3">100 <br> like</p>
            <p class="col-12 my-3" style="border:1px #C1B09D solid;"></p>&nbsp;
        </div>
        <div class="row mb-5">
            <div class="col-md-4 col-sm-12 align-items-center d-flex">
                <h2 class="btn btn-dark" style="border-radius: 25px;">
                    PROMOTION<br/>
                    OF <span style="color:#A33E3E ;">THIS MONTH</span>
                </h2>
            </div>
           
            <div class="col-md-8 col-sm-12">
                <div class="row">
                    <div class="col-12 text-center mr-auto">
                        <div class="row pt-3" id="promotion">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row mb-5 text-center">
            <div class="col-md-4 col-sm-12 pt-5">
                <h2 class="btn btn-dark" style="border-radius: 25px;">OUR TEAM</h2>
            </div>
            <div class="col-md-8 col-sm-12">
                <div class="row">
                    <div class="col-12 text-center mr-auto">
                        <div class="row pt-3" id="barber">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Modal -->
            <div class="modal fade" id="team" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content" style="background-color: black;">
                        <div class="modal-header">
                            <div class="icon m-0">
                                <div class="position-relative">
                                    <img class="circle" src="images/asset-1.png" style="width: 100px; height: 100px;" />
                                </div>
                            </div>
                            <div class="text-left pt-4 text-light">
                                <h4 class="mb-0">COACH</h4>
                                <p>ร้าน : Coach Craftsman</p>
                            </div>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                             <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body text-light">
                            <p>PORTFOLIO</p>
                            <div class="row">
                                <img src="images/asset-7.png" alt="" class="w-50 p-2">
                                <img src="images/asset-8.png" alt="" class="w-50 p-2">
                            </div>
                            <div class="row">
                                <img src="images/asset-9.png" alt="" class="w-50  p-2">
                                <img src="images/asset-10.png" alt="" class="w-50  p-2">
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <hr class="col-12" style="border-bottom:1px solid #EEEBE6;" />
        </div>
        <div class="row mb-5">
            <div class="col-md-4 col-sm-12 pt-5">
                <h2 class="btn btn-dark" style="border-radius: 25px;">SERVICES TYPE</h2>
            </div>
            <div class="col-md-8 col-sm-12">
                <div class="row">
                    <div class="col-12 text-center mr-auto">
                        <div class="row pt-3" id="service">
                        </div>
                    </div>
                </div>
            </div>
            <hr class="col-12" style="border-bottom:1px solid #EEEBE6;" />
        </div>
        <h2 class="text-center">REVIEW OF <br>PHEEN BARBER SHOP</h2>
        <div class="row p-3">
            <div class="col-md col-sm-12 p-0">
                <img src="images/C1.PNG" alt="" class="w-100 p-1">
                <img src="images/C2.PNG" alt="" class="w-100 col-md-6 col-sm-12 p-1 float-left" style="height: 350px;">
                <img src="images/C3.png" alt="" class="w-100 col-md-6 col-sm-12 p-1  " style="height: 350px;">
            </div>
            <div class="col-md col-sm-12 p-0">
                <img src="images/C4.jpg" alt="" class="w-100 p-1">
                <img src="images/C5.png" alt="" class="w-100 col-md-6 col-sm-12 p-1 float-left">
                <img src="images/C6.png" alt="" class="w-100 col-md-6 col-sm-12 p-1" style="height: 270px;">
                <img src="images/C7.png" alt="" class="w-100 p-1" style="height: 275px;">
            </div>
            <a href="" class="col-12">
                <p class="text-black-50 text-right">
                    see more review >></p>
            </a>
            <hr class="col-12" style="border-bottom:1px solid #EEEBE6;" />
        </div>

        <div id="review">
            
        </div>
        <a href="" class="col-12 mb-4">
            <p class="text-black-50 text-right">
                see more review >></p>
        </a>
    </div>
    <!-- container -->
    <footer>
        <div class="container ">
            <div class="foot_logo pt-5 ">
                <img class="logo-img center-block " src="images/logo-app-white.png " />
            </div>

            <div class="footer_text ">
                เว็บแอพพลิเคชั่นรวบรวมร้านตัดผมแฟชั่นชาย และตัดผลบริจาคแบบ Delivery ในเขตกรุงเทพมหานครและปริมณฑล
            </div>


            <div class="foot_icon ">
                <a href="# "><i class="fab fa-facebook "></i></a>
                <a href="# "><i class="fab fa-twitter "></i></a>
                <a href="# "><i class="fab fa-instagram "></i></a>
            </div>
        </div>
    </footer>






    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.1/umd/popper.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script>
        $(function() {
            $('#nav').load("layout/navbar.html");

            $('#ref').attr('href','bookingCustomer.html?id='+getUrlVars()['id'])
            if(!localStorage.getItem('user')) $('#ref').addClass('d-none')

            $.ajax({
                method: "POST",
                url: "service/core.php",
                data: {
                    action: 'get_partner_with_id',
                    id: getUrlVars()['id']
                },
                dataType: 'json',
                // contentType: false,
                // processData: false,
            }).done(function(msg) {
                let data = JSON.parse(msg.result)
                data.barber.map((item)=>{
                    $('#barber').append(barberCard(item))
                })

                data.hairstyle.filter((item)=>item.type === "2").map((item)=>{
                    $('#promotion').append(serviceCard(item))
                })


                data.hairstyle.filter((item)=>item.type === "1").map((item)=>{
                    $('#service').append(serviceCard(item))
                })

                data.review.map((item)=>{
                    $('#review').append(review(item))
                })

                console.log(data)
                $('#name').text(data.partner.biz_name)
                $('#detail').append('<i class="fas fa-map-marker-alt" style="color: #A33E3E;"></i> '+data.partner.biz_house_no + (data.partner.biz_village_no ? ' หมู่ ' +data.partner.biz_village_no:'')+ ' ' +data.partner.biz_sub_area+ ' ' +data.partner.biz_area+ ' ' +data.partner.biz_province+ ' ' +data.partner.biz_postal_code)
                $('#image').attr('src',data.partner.biz_image || 'https://via.placeholder.com/1920x600.png?text=ไม่มีรูป')
            });
        });


        const review = (item) => {
            return `
            <div class="card" style="background-color: #FAF9F7;">
                <div class="card-body">
                    <div class="row pt-3">
                        <div class="col-md-3 col-sm-3 ">
                            <div class="icon">
                                <div class="position-relative">
                                    <img class="circle" src="images/asset-1.png" />
                                </div>
                            </div>
                        </div>
                        <p class="col-md-6 pt-4"><b>${item.username + ' ' + (item.surname ? item.surname : '')}</b><br>${item.detail}</p>
                        <p class="col-md-3  pt-4 text-right">${item.create_at}</p>
                    </div>
                </div>
            </div>`;
        }

        function getUrlVars()
        {
            var vars = [], hash;
            var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
            for(var i = 0; i < hashes.length; i++)
            {
                hash = hashes[i].split('=');
                vars.push(hash[0]);
                vars[hash[0]] = hash[1];
            }
            return vars;
        }

        const serviceCard = (item) => {
            return `
                <div class="col-lg-4">
                    <div class="icon">
                        <div class="position-relative">
                            <img class="img-fluid img-thumbnail" src="${item.image}" />
                            <p style="text-align: center;" class="pt-2"><b>${item.name}</b><br>${item.promotion_price ? `<span style="text-decoration: line-through;">${item.price}</span> <span style="color: #A33E3E; font-size:20px">${item.promotion_price} Baht</span>` : item.price + ' Bath'} </p>
                        </div>
                    </div>
                </div>
                            `
        }

        const barberCard = (item) => {
            return `
                            <div class="col-4">
                                <a href="" data-toggle="modal" data-target="#team">
                                    <div class="icon">
                                        <div class="position-relative">
                                            <img class="circle" src="${item.image}" />
                                            <p style="text-align: center;" class="pt-2 text-dark">ช่าง${item.name}</p>
                                        </div>
                                    </div>
                                </a>
                            </div>`;
        }
    </script>
</body>

</html>